<div class="container">
  <h2>Assigned Assets</h2>
  <button class="btn" (click)="openModal('add')">+ Assign Asset</button>
  <button class="btn print">
    <i class="fa fa-print"></i>
  </button>

  <div class="table-wrapper">
    <table class="asset-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Employee Name</th>
          <th>Employee Email</th>
          <th>Asset Name</th>
          <th>Assigned Date</th>
          <th>Return Date</th>
          <th>Remarks</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let assign of assignments">
          <td>{{ assign.assignmentId }}</td>
          <td>{{ assign.employeeName }}</td>
          <td>{{ assign.employeeEmail }}</td>
          <td>{{ assign.assetName }}</td>
          <td>{{ assign.assignedDate | date:'mediumDate' }}</td>
          <td>{{ assign.returnDate ? (assign.returnDate | date:'mediumDate') : 'Not Returned' }}</td>
          <td>{{ assign.remarks }}</td>
          <td>
            <span [class.damaged]="assign.isDamagedOnReturn" [class.available]="!assign.isDamagedOnReturn">
              {{ assign.isDamagedOnReturn ? 'Damaged' : 'Good Condition' }}
            </span>
          </td>
          <td>
            <button class="btn small" (click)="openModal('edit', assign)">Edit</button>
            <button class="btn small danger" (click)="deleteAssignment(assign.assignmentId)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- âœ… Modal -->
<div class="modal" *ngIf="showModal">
  <div class="modal-content">
    <h3>{{ isEditMode ? 'Edit Assignment' : 'Assign Asset' }}</h3>

    <form class="form-grid" (ngSubmit)="submitAssignment()">
      <div class="form-group">
        <label>Employee</label>
        <select [(ngModel)]="selectedAssignment.employeeId" name="employeeId">
          <option value="">Select Employee</option>
          <!-- <option *ngFor="let emp of employees" [value]="emp.id">{{ emp.fullName }}</option> -->
          <option *ngFor="let emp of employees" [value]="emp.id">{{ emp.fullName }}</option>

        </select>
      </div>

      <div class="form-group">
        <label>Asset</label>
        <select [(ngModel)]="selectedAssignment.assetId" name="assetId">
          <option value="">Select Asset</option>
          <option *ngFor="let a of assets" [value]="a.id">{{ a.assetName }}</option>
        </select>
      </div>

      <div class="form-group">
        <label>Remarks</label>
        <input type="text" [(ngModel)]="selectedAssignment.remarks" name="remarks" />
      </div>

      <div class="form-group">
        <label>Damaged on Return</label>
        <select [(ngModel)]="selectedAssignment.isDamagedOnReturn" name="isDamagedOnReturn">
          <option [ngValue]="false">No</option>
          <option [ngValue]="true">Yes</option>
        </select>
      </div>

      <div class="form-actions">
        <button type="button" class="btn" (click)="closeModal()">Cancel</button>
        <button type="submit" class="btn primary">
          {{ isEditMode ? 'Update' : 'Assign' }}
        </button>
      </div>
    </form>
  </div>
</div>